define("pages/myaccount",["modules/backbone-mozu","hyprlive","modules/jquery-mozu","underscore","modules/models-customer","modules/views-paging"],function(t,e,n,i,d,a){var r=t.MozuView.extend({constructor:function(){t.MozuView.apply(this,arguments),this.editing={}},getRenderContext:function(){var e=t.MozuView.prototype.getRenderContext.apply(this,arguments);return e.editing=this.editing,e},doModelAction:function(t,e){var n=this,i=function(){n.render()},d=this.model[t](e);return d&&d.then?(d.then(i,i),d):void 0}}),o=r.extend({templateName:"modules/my-account/my-account-settings",autoUpdate:["firstName","lastName","oldPassword","password","confirmPassword","acceptsMarketing"],updateAcceptsMarketing:function(t){var e=n(t.currentTarget).prop("checked");this.model.set("acceptsMarketing",e),this.model.updateAcceptsMarketing(e)},startEditName:function(){this.editing.name=!0,this.render()},cancelEditName:function(){this.editing.name=!1,this.render()},finishEditName:function(){this.doModelAction("updateName"),this.editing.name=!1},startEditPassword:function(){this.editing.password=!0,this.render()},finishEditPassword:function(){var t=this;this.doModelAction("changePassword").then(function(){i.delay(function(){t.$('[data-mz-validationmessage-for="passwordChanged"]').show().text(e.getLabel("passwordChanged")).fadeOut(3e3)},250)}),this.editing.password=!1},cancelEditPassword:function(){this.editing.password=!1,this.render()}}),s=r.extend({templateName:"modules/my-account/my-account-wishlist",addItemToCart:function(t){var e=n(t.currentTarget),i=e.data("mzItemId");return i?(this.editing.added=i,this.doModelAction("addItemToCart",i)):void 0},doNotRemove:function(){this.editing.added=!1,this.editing.remove=!1,this.render()},beginRemoveItem:function(t){var e=n(t.currentTarget).data("mzItemId");e&&(this.editing.remove=e,this.render())},finishRemoveItem:function(t){var e=this,i=n(t.currentTarget).data("mzItemId");return this.model.apiDeleteItem(i).then(function(){return e.editing.remove=!1,e.model.apiGet()})}}),c=t.MozuView.extend({templateName:"modules/my-account/order-history-list",autoUpdate:["rma.returnType","rma.reason","rma.quantity","rma.comments"],initialize:function(){this.listenTo(this.model,"change:pageSize",i.bind(this.model.changePageSize,this.model))},getRenderContext:function(){var e=t.MozuView.prototype.getRenderContext.apply(this,arguments);return e.returning=this.returning,e},startReturnItem:function(t){var e=n(t.currentTarget),i=e.data("mzStartReturn"),d=e.data("mzOrderId");i&&d&&(this.returning=i,this.model.startReturn(d,i)),this.render()},cancelReturnItem:function(){delete this.returning,this.model.clearReturn(),this.render()},finishReturnItem:function(){var t=this,e=this.model.finishReturn();return e?e.then(function(){delete t.returning,t.render()}):void 0}}),m=t.MozuView.extend({templateName:"modules/my-account/return-history-list",initialize:function(){var t=this;this.listenTo(this.model,"change:pageSize",i.bind(this.model.changePageSize,this.model)),this.listenTo(this.model,"returndisplayed",function(e){var n=t.$('[data-mz-id="'+e+'"]');0===n.length&&(n=t.$el),n.ScrollTo({axis:"y"})})}}),g=r.extend({templateName:"modules/my-account/my-account-paymentmethods",autoUpdate:["editingCard.paymentOrCardType","editingCard.nameOnCard","editingCard.cardNumberPartOrMask","editingCard.expireMonth","editingCard.expireYear","editingCard.cvv","editingCard.isCvvOptional","editingCard.contactId","editingContact.firstName","editingContact.lastNameOrSurname","editingContact.address.address1","editingContact.address.address2","editingContact.address.address3","editingContact.address.cityOrTown","editingContact.address.countryCode","editingContact.address.stateOrProvince","editingContact.address.postalOrZipCode","editingContact.address.addressType","editingContact.phoneNumbers.home","editingContact.isBillingContact","editingContact.isPrimaryBillingContact","editingContact.isShippingContact","editingContact.isPrimaryShippingContact"],renderOnChange:["editingCard.contactId","editingContact.address.countryCode"],beginEditCard:function(t){var e=this.editing.card=t.currentTarget.getAttribute("data-mz-card");this.model.beginEditCard(e),this.render()},finishEditCard:function(){this.doModelAction("saveCard")&&(this.editing.card=!1)},cancelEditCard:function(){this.editing.card=!1,this.model.endEditCard(),this.render()},beginDeleteCard:function(t){var n=t.currentTarget.getAttribute("data-mz-card"),i=this.model.get("cards").get(n);window.confirm(e.getLabel("confirmDeleteCard",i.get("cardNumberPart")))&&this.doModelAction("deleteCard",n)}}),u=r.extend({templateName:"modules/my-account/my-account-addressbook",autoUpdate:["editingContact.firstName","editingContact.lastNameOrSurname","editingContact.address.address1","editingContact.address.address2","editingContact.address.address3","editingContact.address.cityOrTown","editingContact.address.countryCode","editingContact.address.stateOrProvince","editingContact.address.postalOrZipCode","editingContact.address.addressType","editingContact.phoneNumbers.home","editingContact.isBillingContact","editingContact.isPrimaryBillingContact","editingContact.isShippingContact","editingContact.isPrimaryShippingContact"],renderOnChange:["editingContact.address.countryCode","editingContact.isBillingContact","editingContact.isShippingContact"],beginAddContact:function(){this.editing.contact="new",this.render()},beginEditContact:function(t){var e=this.editing.contact=t.currentTarget.getAttribute("data-mz-contact");this.model.beginEditContact(e),this.render()},finishEditContact:function(){this.doModelAction("saveContact")&&(this.editing.contact=!1)},cancelEditContact:function(){this.editing.contact=!1,this.model.endEditContact(),this.render()},beginDeleteContact:function(t){var n=t.currentTarget.getAttribute("data-mz-contact"),i=this.model.get("contacts").get(n);window.confirm(e.getLabel("confirmDeleteContact",i.get("address").get("address1")))&&this.doModelAction("deleteContact",n)}}),l=t.MozuView.extend({templateName:"modules/my-account/my-account-storecredit",addStoreCredit:function(){var t=this,e=this.$("[data-mz-entering-credit]").val();return e?this.model.addStoreCredit(e).then(function(){return t.model.getStoreCredits()}):void 0}});n(document).ready(function(){var t=window.accountModel=d.EditableCustomer.fromCurrent(),r=n("#account-settings"),h=n("#account-orderhistory"),C=n("#account-returnhistory"),p=n("#account-paymentmethods"),f=n("#account-addressbook"),y=n("#account-wishlist"),w=n("#account-messages"),v=n("#account-storecredit"),z=t.get("orderHistory"),b=t.get("returnHistory"),N=window.accountViews={settings:new o({el:r,model:t,messagesEl:w}),orderHistory:new c({el:h.find("[data-mz-orderlist]"),model:z}),orderHistoryPagingControls:new a.PagingControls({templateName:"modules/my-account/order-history-paging-controls",el:h.find("[data-mz-pagingcontrols]"),model:z}),orderHistoryPageNumbers:new a.PageNumbers({el:h.find("[data-mz-pagenumbers]"),model:z}),returnHistory:new m({el:C.find("[data-mz-orderlist]"),model:b}),returnHistoryPagingControls:new a.PagingControls({templateName:"modules/my-account/order-history-paging-controls",el:C.find("[data-mz-pagingcontrols]"),model:b}),returnHistoryPageNumbers:new a.PageNumbers({el:C.find("[data-mz-pagenumbers]"),model:b}),paymentMethods:new g({el:p,model:t,messagesEl:w}),addressBook:new u({el:f,model:t,messagesEl:w}),storeCredit:new l({el:v,model:t,messagesEl:w})};e.getThemeSetting("allowWishlist")&&(N.wishList=new s({el:y,model:t.get("wishlist"),messagesEl:w})),i.invoke(window.accountViews,"render")})});